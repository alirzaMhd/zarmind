<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <!-- Meta -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="Content-Language" content="fa" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#0f172a" />

    <title>زرمند | سیستم حسابداری هوشمند طلافروشی</title>
    <meta
      name="description"
      content="زرمند - سیستم حسابداری هوشمند برای مدیریت طلا و جواهر، انبار، فروش، مشتریان و گزارش‌ها با پشتیبانی از OCR ترازو"
    />

    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json" />

    <!-- Favicon & Icons (optional placeholders) -->
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/icon-32.png" />
    <link rel="apple-touch-icon" href="./assets/icons/icon-192.png" />

    <!-- Fonts (Local Vazir) -->
    <style>
      @font-face {
        font-family: "Vazir";
        src: url("./assets/fonts/Vazir/Vazir.woff2") format("woff2"),
             url("./assets/fonts/Vazir/Vazir.woff") format("woff");
        font-weight: 100 900;
        font-style: normal;
        font-display: swap;
      }

      :root {
        --font-fa: "Vazir", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue",
          Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
        --bg: #0b1020;
        --bg-elev: #0f172a;
        --text: #e5e7eb;
        --muted: #94a3b8;
        --accent: #22c55e;
        --accent-2: #0ea5e9;
        --danger: #ef4444;
        --card: #111828;
        --border: #1f2937;
        --nav: #0c1224;
        --sidebar: #0d1428;
        --badge: #1e293b;
      }

      html, body {
        height: 100%;
        background: var(--bg);
        color: var(--text);
        font-family: var(--font-fa);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* Minimal layout skeleton (fallback while app loads) */
      body {
        margin: 0;
        display: grid;
        grid-template-rows: 56px 1fr;
        grid-template-columns: 260px 1fr;
        grid-template-areas:
          "header header"
          "sidebar main";
      }
      header {
        grid-area: header;
        background: var(--nav);
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 0 16px;
      }
      header .brand {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 700;
        font-size: 16px;
      }
      header .brand img {
        width: 28px;
        height: 28px;
        object-fit: contain;
      }
      header .spacer {
        flex: 1;
      }
      header .user {
        color: var(--muted);
        font-size: 13px;
      }

      aside#sidebar {
        grid-area: sidebar;
        background: var(--sidebar);
        border-inline-end: 1px solid var(--border);
        overflow: auto;
      }
      nav.menu {
        display: grid;
        gap: 4px;
        padding: 12px;
      }
      nav.menu a {
        display: flex;
        align-items: center;
        gap: 10px;
        text-decoration: none;
        color: var(--text);
        padding: 10px 12px;
        border-radius: 8px;
        font-size: 14px;
        border: 1px solid transparent;
      }
      nav.menu a:hover {
        background: var(--card);
        border-color: var(--border);
      }
      nav.menu a.active {
        background: linear-gradient(135deg, rgba(34,197,94,.15), rgba(14,165,233,.15));
        border-color: #164e63;
      }
      nav.menu .section {
        margin-top: 10px;
        margin-bottom: 4px;
        padding: 0 6px;
        color: var(--muted);
        font-size: 11px;
      }

      main#app {
        grid-area: main;
        min-height: 0;
        overflow: auto;
        position: relative;
        background: radial-gradient(1200px 600px at 50% -200px, rgba(34,197,94,.06), transparent 50%),
          radial-gradient(900px 400px at 100% 0px, rgba(14,165,233,.06), transparent 40%);
      }

      /* Loading state */
      #app .loading {
        display: grid;
        place-items: center;
        height: 100%;
        gap: 16px;
        color: var(--muted);
      }
      .spinner {
        inline-size: 32px;
        block-size: 32px;
        border-radius: 50%;
        border: 3px solid rgba(148,163,184,.2);
        border-top-color: var(--accent);
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      /* Responsive */
      @media (max-width: 1024px) {
        body {
          grid-template-columns: 1fr;
          grid-template-areas:
            "header"
            "main";
        }
        aside#sidebar {
          display: none; /* sidebar is managed by app (drawer) in small screens */
        }
      }
    </style>

    <!-- Main CSS (built) -->
    <link rel="stylesheet" href="./dist/css/styles.min.css" />

    <!-- Optional RTL (if separated in build) -->
    <link rel="stylesheet" href="./dist/css/rtl.css" media="all" />

    <!-- Fallback (non-built) styles - optional (will 404 harmlessly in prod) -->
    <link rel="stylesheet" href="./../src/css/variables.css" />
    <link rel="stylesheet" href="./../src/css/components.css" />
    <link rel="stylesheet" href="./../src/css/main.css" />
    <link rel="stylesheet" href="./../src/css/rtl.css" />
  </head>

  <body data-theme="dark">
    <!-- Header -->
    <header>
      <div class="brand">
        <img src="./assets/images/logo.png" alt="Zarmind" />
        <span>زرمند</span>
      </div>
      <div class="spacer"></div>
      <div class="user" id="header-user">در حال بارگذاری…</div>
    </header>

    <!-- Sidebar (basic static skeleton; the app will render the real one) -->
    <aside id="sidebar" aria-label="Sidebar">
      <nav class="menu" id="sidebar-menu">
        <div class="section">منو</div>
        <a href="#/dashboard" data-route="dashboard">داشبورد</a>
        <a href="#/inventory" data-route="inventory">موجودی</a>
        <a href="#/sales" data-route="sales">فروش</a>
        <a href="#/customers" data-route="customers">مشتریان</a>
        <a href="#/reports" data-route="reports">گزارش‌ها</a>
        <a href="#/settings" data-route="settings">تنظیمات</a>
        <div class="section">حساب کاربری</div>
        <a href="#/login" data-route="login">ورود</a>
      </nav>
    </aside>

    <!-- App Root -->
    <main id="app">
      <div class="loading" id="app-loading">
        <div class="spinner" aria-hidden="true"></div>
        <div>در حال بارگذاری برنامه…</div>
      </div>
      <noscript>
        برای استفاده از زرمند، لطفاً جاوااسکریپت را در مرورگر خود فعال کنید.
      </noscript>
    </main>

    <!-- Global config (accessible to app.js) -->
    <script>
      window.__ZARMIND__ = {
        apiBaseUrl: (localStorage.getItem('apiBaseUrl') || '') || (location.origin.replace(/:\d+$/, ':3000') + '/api'),
        appVersion: '1.0.0',
        rtl: true,
      };
    </script>

    <!-- App Script (built) -->
    
    <script src="./dist/js/bundle.js"></script>

    <!-- Service Worker (optional) -->
    <script>
      if ('serviceWorker' in navigator) {
        // Optional: register sw.js if you add one
        // navigator.serviceWorker.register('./sw.js').catch(()=>{});
      }
    </script>
  </body>
</html>